# å­¦ä¹ ç¬”è®° 2.2 - æ ¸å¿ƒ UI ç»„ä»¶ï¼ˆæ‰‹æŠŠæ‰‹æ•™ç¨‹ï¼‰

## ğŸ“– æœ¬èŠ‚ç›®æ ‡

å­¦ä¹ å¦‚ä½•è®¾è®¡å’Œå®ç°å¯å¤ç”¨çš„ç»ˆç«¯ UI ç»„ä»¶ï¼ŒåŒ…æ‹¬ï¼š
1. æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶ï¼ˆç±»ä¼¼èŠå¤©è®°å½•ï¼‰
2. åŠ è½½åŠ¨ç”»ç»„ä»¶ï¼ˆæ˜¾ç¤º"æ­£åœ¨å¤„ç†..."ï¼‰
3. è¾“å…¥æ¡†ç»„ä»¶ï¼ˆå¸¦å†å²è®°å½•ï¼‰

**å­¦ä¹ æ–¹å¼**ï¼šæ¯ä¸ªç»„ä»¶éƒ½ä¼šä»é›¶å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥å®ç°ï¼Œä¸è·³è¿‡ä»»ä½•ç»†èŠ‚ã€‚

---

## ğŸ¯ ç»ƒä¹  1ï¼šæ¶ˆæ¯åˆ—è¡¨ç»„ä»¶

### ğŸ“ éœ€æ±‚åˆ†æ

æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªç±»ä¼¼èŠå¤©åº”ç”¨çš„æ¶ˆæ¯åˆ—è¡¨ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼š
- æ˜¾ç¤ºå¤šæ¡æ¶ˆæ¯
- æ¯æ¡æ¶ˆæ¯æœ‰ä¸åŒçš„å‘é€è€…ï¼ˆç”¨æˆ· vs AIï¼‰
- ä¸åŒå‘é€è€…çš„æ¶ˆæ¯ç”¨ä¸åŒé¢œè‰²åŒºåˆ†
- æ”¯æŒæ»šåŠ¨ï¼ˆå½“æ¶ˆæ¯å¾ˆå¤šæ—¶ï¼‰

### ğŸ¨ æœ€ç»ˆæ•ˆæœé¢„è§ˆ

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’¬ èŠå¤©è®°å½•

ğŸ‘¤ ç”¨æˆ·: ä½ å¥½
ğŸ¤– AI: ä½ å¥½ï¼æˆ‘æ˜¯ AI åŠ©æ‰‹
ğŸ‘¤ ç”¨æˆ·: ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ
ğŸ¤– AI: æŠ±æ­‰ï¼Œæˆ‘æ— æ³•æŸ¥çœ‹å®æ—¶å¤©æ°”
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

### ğŸ“‚ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç»„ä»¶ç›®å½•ç»“æ„

**åœ¨å“ªé‡Œåš**ï¼šåœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•

**ç›®çš„**ï¼šç»„ç»‡ä»£ç ï¼Œè®©ç»„ä»¶æ–‡ä»¶æœ‰ä¸“é—¨çš„å­˜æ”¾ä½ç½®

**æ‰§è¡Œå‘½ä»¤**ï¼š
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
mkdir -p packages/cli/src/components
```

**åç«¯ç±»æ¯”**ï¼šå°±åƒ Spring Boot é¡¹ç›®ä¸­åˆ›å»º `controller/`ã€`service/`ã€`model/` ç›®å½•ä¸€æ ·ã€‚

---

### ğŸ“„ ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ¶ˆæ¯æ•°æ®ç±»å‹å®šä¹‰

**åœ¨å“ªé‡Œåš**ï¼š`packages/cli/src/components/MessageList.tsx`

**ç›®çš„**ï¼šå®šä¹‰æ¶ˆæ¯çš„æ•°æ®ç»“æ„ï¼ˆTypeScript ç±»å‹ï¼‰

**ä»£ç **ï¼š
```tsx
// packages/cli/src/components/MessageList.tsx

// ç¬¬ä¸€æ­¥ï¼šå®šä¹‰æ¶ˆæ¯ç±»å‹
type Message = {
	id: number;           // æ¶ˆæ¯ IDï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
	sender: 'user' | 'ai'; // å‘é€è€…ï¼šç”¨æˆ·æˆ– AI
	content: string;       // æ¶ˆæ¯å†…å®¹
};
```

**åç«¯ç±»æ¯”**ï¼š
```java
// ç±»ä¼¼äº Java çš„å®ä½“ç±»
public class Message {
    private Long id;
    private String sender; // "user" æˆ– "ai"
    private String content;
}
```

---

### ğŸ¨ ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå•æ¡æ¶ˆæ¯ç»„ä»¶

**åœ¨å“ªé‡Œåš**ï¼šåŒä¸€ä¸ªæ–‡ä»¶ `MessageList.tsx`

**ç›®çš„**ï¼šå…ˆå®ç°æœ€å°å•å…ƒï¼ˆå•æ¡æ¶ˆæ¯ï¼‰ï¼Œå†ç»„åˆæˆåˆ—è¡¨

**ä»£ç **ï¼š
```tsx
import { Text, Box } from 'ink';

// å•æ¡æ¶ˆæ¯ç»„ä»¶
type MessageItemProps = {
	message: Message;
};

const MessageItem = ({ message }: MessageItemProps) => {
	// æ ¹æ®å‘é€è€…é€‰æ‹©é¢œè‰²å’Œå›¾æ ‡
	const isUser = message.sender === 'user';
	const icon = isUser ? 'ğŸ‘¤' : 'ğŸ¤–';
	const color = isUser ? 'cyan' : 'green';
	const label = isUser ? 'ç”¨æˆ·' : 'AI';

	return (
		<Box>
			<Text color={color}>
				{icon} {label}: {message.content}
			</Text>
		</Box>
	);
};
```

**çŸ¥è¯†ç‚¹è§£é‡Š**ï¼š

1. **Props ç±»å‹å®šä¹‰**ï¼š
   ```tsx
   type MessageItemProps = {
       message: Message;
   };
   ```
   - å®šä¹‰ç»„ä»¶æ¥æ”¶çš„å‚æ•°ç±»å‹
   - åç«¯ç±»æ¯”ï¼šæ–¹æ³•çš„å‚æ•°ç±»å‹å£°æ˜

2. **æ¡ä»¶æ¸²æŸ“**ï¼š
   ```tsx
   const isUser = message.sender === 'user';
   const icon = isUser ? 'ğŸ‘¤' : 'ğŸ¤–';
   ```
   - æ ¹æ®æ¡ä»¶é€‰æ‹©ä¸åŒçš„å€¼
   - åç«¯ç±»æ¯”ï¼š`if-else` æˆ–ä¸‰å…ƒè¿ç®—ç¬¦

3. **ç»„ä»¶è¿”å› JSX**ï¼š
   ```tsx
   return <Box>...</Box>;
   ```
   - è¿”å› UI ç»“æ„
   - åç«¯ç±»æ¯”ï¼šè¿”å› HTML æ¨¡æ¿ï¼ˆå¦‚ Thymeleafï¼‰

---

### ğŸ“‹ ç¬¬å››æ­¥ï¼šåˆ›å»ºæ¶ˆæ¯åˆ—è¡¨ç»„ä»¶

**åœ¨å“ªé‡Œåš**ï¼šåŒä¸€ä¸ªæ–‡ä»¶ `MessageList.tsx`

**ç›®çš„**ï¼šå°†å¤šæ¡æ¶ˆæ¯ç»„åˆæˆåˆ—è¡¨

**ä»£ç **ï¼š
```tsx
import { useState } from 'react';

// æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶
export const MessageList = () => {
	// ä½¿ç”¨ useState ç®¡ç†æ¶ˆæ¯åˆ—è¡¨
	const [messages] = useState<Message[]>([
		{ id: 1, sender: 'user', content: 'ä½ å¥½' },
		{ id: 2, sender: 'ai', content: 'ä½ å¥½ï¼æˆ‘æ˜¯ AI åŠ©æ‰‹' },
		{ id: 3, sender: 'user', content: 'ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ' },
		{ id: 4, sender: 'ai', content: 'æŠ±æ­‰ï¼Œæˆ‘æ— æ³•æŸ¥çœ‹å®æ—¶å¤©æ°”' },
	]);

	return (
		<Box flexDirection="column" padding={1}>
			{/* æ ‡é¢˜ */}
			<Text bold color="yellow">
				â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
			</Text>
			<Text bold color="magenta">
				ğŸ’¬ èŠå¤©è®°å½•
			</Text>
			<Text bold color="yellow">
				â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
			</Text>

			{/* æ¶ˆæ¯åˆ—è¡¨ */}
			<Box flexDirection="column" marginTop={1}>
				{messages.map((message) => (
					<MessageItem key={message.id} message={message} />
				))}
			</Box>
		</Box>
	);
};
```

**çŸ¥è¯†ç‚¹è§£é‡Š**ï¼š

1. **æ•°ç»„æ¸²æŸ“**ï¼š
   ```tsx
   {messages.map((message) => (
       <MessageItem key={message.id} message={message} />
   ))}
   ```
   - éå†æ•°ç»„ï¼Œä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºä¸€ä¸ªç»„ä»¶
   - `key` æ˜¯å¿…éœ€çš„ï¼Œå¸®åŠ© React è¯†åˆ«å“ªä¸ªå…ƒç´ å˜åŒ–äº†
   - åç«¯ç±»æ¯”ï¼š`for` å¾ªç¯æˆ– `forEach`

2. **`flexDirection="column"`**ï¼š
   - å‚ç›´æ’åˆ—å­å…ƒç´ ï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰
   - åç«¯ç±»æ¯”ï¼šCSS çš„ `flex-direction: column`

---

### ğŸ”§ ç¬¬äº”æ­¥ï¼šå®Œæ•´ä»£ç æ•´ç†

**å®Œæ•´çš„ `MessageList.tsx` æ–‡ä»¶**ï¼š

```tsx
import { useState } from 'react';
import { Text, Box } from 'ink';

// ========== ç±»å‹å®šä¹‰ ==========
type Message = {
	id: number;
	sender: 'user' | 'ai';
	content: string;
};

type MessageItemProps = {
	message: Message;
};

// ========== å•æ¡æ¶ˆæ¯ç»„ä»¶ ==========
const MessageItem = ({ message }: MessageItemProps) => {
	const isUser = message.sender === 'user';
	const icon = isUser ? 'ğŸ‘¤' : 'ğŸ¤–';
	const color = isUser ? 'cyan' : 'green';
	const label = isUser ? 'ç”¨æˆ·' : 'AI';

	return (
		<Box>
			<Text color={color}>
				{icon} {label}: {message.content}
			</Text>
		</Box>
	);
};

// ========== æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶ ==========
export const MessageList = () => {
	const [messages] = useState<Message[]>([
		{ id: 1, sender: 'user', content: 'ä½ å¥½' },
		{ id: 2, sender: 'ai', content: 'ä½ å¥½ï¼æˆ‘æ˜¯ AI åŠ©æ‰‹' },
		{ id: 3, sender: 'user', content: 'ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ' },
		{ id: 4, sender: 'ai', content: 'æŠ±æ­‰ï¼Œæˆ‘æ— æ³•æŸ¥çœ‹å®æ—¶å¤©æ°”' },
	]);

	return (
		<Box flexDirection="column" padding={1}>
			<Text bold color="yellow">
				â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
			</Text>
			<Text bold color="magenta">
				ğŸ’¬ èŠå¤©è®°å½•
			</Text>
			<Text bold color="yellow">
				â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
			</Text>

			<Box flexDirection="column" marginTop={1}>
				{messages.map((message) => (
					<MessageItem key={message.id} message={message} />
				))}
			</Box>
		</Box>
	);
};
```

---

### ğŸ§ª ç¬¬å…­æ­¥ï¼šåœ¨ä¸»åº”ç”¨ä¸­ä½¿ç”¨ç»„ä»¶

**åœ¨å“ªé‡Œåš**ï¼š`packages/cli/src/index.tsx`

**ç›®çš„**ï¼šæµ‹è¯•æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ç»„ä»¶

**ä»£ç **ï¼š
```tsx
import { render } from 'ink';
import { MessageList } from './components/MessageList.js';

export async function main() {
	render(<MessageList />);
}
```

**æ³¨æ„äº‹é¡¹**ï¼š
- å¼•å…¥è·¯å¾„è¦åŠ  `.js` åç¼€ï¼ˆå› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯ ES Moduleï¼‰
- å³ä½¿æºæ–‡ä»¶æ˜¯ `.tsx`ï¼Œç¼–è¯‘åæ˜¯ `.js`ï¼Œæ‰€ä»¥å¼•å…¥æ—¶ç”¨ `.js`

---

### ğŸš€ ç¬¬ä¸ƒæ­¥ï¼šæ„å»ºå’Œè¿è¡Œ

**åœ¨å“ªé‡Œåš**ï¼šé¡¹ç›®æ ¹ç›®å½•

**æ‰§è¡Œå‘½ä»¤**ï¼š
```bash
# 1. æ„å»º
npm run bundle

# 2. è¿è¡Œ
node bundle/cli-demo.js
```

**é¢„æœŸç»“æœ**ï¼š
ä½ åº”è¯¥çœ‹åˆ°ä¸€ä¸ªæ¼‚äº®çš„èŠå¤©è®°å½•ç•Œé¢ï¼Œæ˜¾ç¤º 4 æ¡æ¶ˆæ¯ã€‚

---

## ğŸ¯ ç»ƒä¹  2ï¼šåŠ è½½åŠ¨ç”»ç»„ä»¶

### ğŸ“ éœ€æ±‚åˆ†æ

å®ç°ä¸€ä¸ª"æ­£åœ¨åŠ è½½..."çš„åŠ¨ç”»ï¼Œç”¨äºæ˜¾ç¤ºå¼‚æ­¥æ“ä½œè¿›åº¦ã€‚

### ğŸ¨ æœ€ç»ˆæ•ˆæœé¢„è§ˆ

```
â ‹ æ­£åœ¨å¤„ç†ï¼Œè¯·ç¨å€™...
```
ï¼ˆåœ†åœˆä¼šæ—‹è½¬ï¼‰

---

### ğŸ“„ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºåŠ è½½ç»„ä»¶æ–‡ä»¶

**åœ¨å“ªé‡Œåš**ï¼š`packages/cli/src/components/Spinner.tsx`

**ä»£ç **ï¼š
```tsx
import { Text } from 'ink';
import InkSpinner from 'ink-spinner';

type SpinnerProps = {
	message?: string; // å¯é€‰çš„æç¤ºæ¶ˆæ¯
};

export const Spinner = ({ message = 'åŠ è½½ä¸­...' }: SpinnerProps) => {
	return (
		<Text>
			<Text color="cyan">
				<InkSpinner type="dots" />
			</Text>
			{' '}
			<Text dimColor>{message}</Text>
		</Text>
	);
};
```

**çŸ¥è¯†ç‚¹è§£é‡Š**ï¼š

1. **å¯é€‰å‚æ•°**ï¼š
   ```tsx
   message?: string;
   ```
   - `?` è¡¨ç¤ºè¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„
   - åç«¯ç±»æ¯”ï¼šJava çš„ `@Nullable` æˆ– Optional

2. **é»˜è®¤å€¼**ï¼š
   ```tsx
   { message = 'åŠ è½½ä¸­...' }
   ```
   - å¦‚æœæ²¡æœ‰ä¼ å…¥ `message`ï¼Œä½¿ç”¨é»˜è®¤å€¼
   - åç«¯ç±»æ¯”ï¼šæ–¹æ³•å‚æ•°çš„é»˜è®¤å€¼

3. **ä½¿ç”¨ç¬¬ä¸‰æ–¹ç»„ä»¶**ï¼š
   - `ink-spinner` æ˜¯ä¸€ä¸ªç°æˆçš„åŠ è½½åŠ¨ç”»ç»„ä»¶
   - åç«¯ç±»æ¯”ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Apache Commonsï¼‰

---

### ğŸ“¦ ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–

**åœ¨å“ªé‡Œåš**ï¼šé¡¹ç›®æ ¹ç›®å½•

**ç›®çš„**ï¼šå®‰è£… `ink-spinner` åŒ…

**æ‰§è¡Œå‘½ä»¤**ï¼š
```bash
npm install ink-spinner --workspace packages/cli
```

**ç­‰å¾…å®‰è£…å®Œæˆ**ï¼ˆå¯èƒ½éœ€è¦å‡ ç§’é’Ÿï¼‰

---

### ğŸ§ª ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•åŠ è½½ç»„ä»¶

**åœ¨å“ªé‡Œåš**ï¼š`packages/cli/src/index.tsx`

**ä»£ç **ï¼š
```tsx
import { render } from 'ink';
import { Spinner } from './components/Spinner.js';

export async function main() {
	render(<Spinner message="æ­£åœ¨å¤„ç†ï¼Œè¯·ç¨å€™..." />);
}
```

---

### ğŸš€ ç¬¬å››æ­¥ï¼šæ„å»ºå’Œè¿è¡Œ

```bash
npm run bundle
node bundle/cli-demo.js
```

**é¢„æœŸç»“æœ**ï¼š
ä½ åº”è¯¥çœ‹åˆ°ä¸€ä¸ªæ—‹è½¬çš„åŠ è½½åŠ¨ç”»ã€‚

---

## ğŸ“š æœ¬èŠ‚æ€»ç»“

### âœ… ä½ å­¦åˆ°äº†ä»€ä¹ˆ

1. **ç»„ä»¶åŒ–æ€æƒ³**
   - å°† UI æ‹†åˆ†æˆå°çš„ã€å¯å¤ç”¨çš„ç»„ä»¶
   - å•ä¸€èŒè´£åŸåˆ™ï¼ˆæ¯ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹ï¼‰

2. **TypeScript ç±»å‹ç³»ç»Ÿ**
   - å®šä¹‰æ•°æ®ç±»å‹ï¼ˆ`type Message`ï¼‰
   - å®šä¹‰ç»„ä»¶ Props ç±»å‹
   - å¯é€‰å‚æ•°å’Œé»˜è®¤å€¼

3. **React æ ¸å¿ƒæ¦‚å¿µ**
   - `useState`ï¼šç®¡ç†çŠ¶æ€
   - `map`ï¼šæ¸²æŸ“åˆ—è¡¨
   - `key`ï¼šå¸®åŠ© React è¯†åˆ«å…ƒç´ 

4. **Ink å¸ƒå±€**
   - `<Box>`ï¼šå®¹å™¨ç»„ä»¶
   - `flexDirection`ï¼šæ§åˆ¶æ’åˆ—æ–¹å‘
   - `padding`ã€`margin`ï¼šé—´è·æ§åˆ¶

### ğŸ¯ ä¸‹ä¸€æ­¥

ç»§ç»­ç»ƒä¹  3ï¼šåˆ›å»ºä¸€ä¸ªå¸¦å†å²è®°å½•çš„è¾“å…¥æ¡†ç»„ä»¶ã€‚

---

## ğŸ”— å‚è€ƒèµ„æº

- [Ink å®˜æ–¹æ–‡æ¡£](https://github.com/vadimdemedes/ink)
- [ink-spinner æ–‡æ¡£](https://github.com/vadimdemedes/ink-spinner)
- [React TypeScript å¤‡å¿˜å•](https://react-typescript-cheatsheet.netlify.app/)
