# .js vs .mjs çš„åŒºåˆ«è¯¦è§£

## ğŸ¤” ä½ çš„é—®é¢˜

> "mjs å’Œ jsçš„åŒºåˆ«ï¼Ÿ æˆ‘çœ‹gemini-cliä¸æ˜¯ç”¨çš„jså—"

ä½ çš„è§‚å¯Ÿéå¸¸å‡†ç¡®ï¼Gemini-CLI ç¡®å®ä½¿ç”¨çš„æ˜¯ `.js` æ‰©å±•åï¼Œè€Œä¸æ˜¯ `.mjs`ã€‚è®©æˆ‘è¯¦ç»†è§£é‡Šä¸¤è€…çš„åŒºåˆ«å’Œå¦‚ä½•é€‰æ‹©ã€‚

---

## ğŸ“š èƒŒæ™¯çŸ¥è¯†

### CommonJS vs ES Module

Node.js æ”¯æŒä¸¤ç§æ¨¡å—ç³»ç»Ÿï¼š

| ç‰¹æ€§ | CommonJS (CJS) | ES Module (ESM) |
|------|---------------|-----------------|
| **å¯¼å…¥** | `require('package')` | `import pkg from 'package'` |
| **å¯¼å‡º** | `module.exports = {...}` | `export default {...}` |
| **æ–‡ä»¶æ‰©å±•åé»˜è®¤** | `.js` | `.mjs` |
| **å…¼å®¹æ€§** | æ—§æ ‡å‡†ï¼Œå‘åå…¼å®¹ | æ–°æ ‡å‡†ï¼Œç°ä»£æ¨è |

**é—®é¢˜**: Node.js é»˜è®¤æŠŠ `.js` æ–‡ä»¶å½“ä½œ CommonJS æ¨¡å—ï¼

---

## ğŸ”‘ å‘Šè¯‰ Node.js ä½¿ç”¨ ES Module çš„ä¸¤ç§æ–¹å¼

### æ–¹å¼ 1: åœ¨ package.json æ·»åŠ  `"type": "module"` âœ… (æ¨è)

**Gemini-CLI çš„åšæ³•**:

```json
// package.json
{
  "name": "@google/gemini-cli",
  "type": "module",  // â† å…³é”®ï¼å‘Šè¯‰ Node.js æ‰€æœ‰ .js éƒ½æ˜¯ ESM
  ...
}
```

**æ•ˆæœ**:
- âœ… æ‰€æœ‰ `.js` æ–‡ä»¶éƒ½è¢«è¯†åˆ«ä¸º ES Module
- âœ… å¯ä»¥åœ¨ .js æ–‡ä»¶ä¸­ä½¿ç”¨ `import/export`
- âœ… é…ç½®è„šæœ¬ä¹Ÿç”¨ `.js`ï¼ˆå¦‚ `esbuild.config.js`ï¼‰
- âœ… ä»£ç æ›´ç®€æ´ç»Ÿä¸€

**æ–‡ä»¶ç¤ºä¾‹**:
```javascript
//  esbuild.config.js (æ³¨æ„æ˜¯ .jsï¼Œä¸æ˜¯ .mjs)
import esbuild from 'esbuild';  // âœ… å¯ä»¥ç”¨ import
console.log('Hello ESM');
```

### æ–¹å¼ 2: ä½¿ç”¨ `.mjs` æ‰©å±•å

**ä¸éœ€è¦ä¿®æ”¹ package.json**:

```javascript
// esbuild.config.mjs (ç”¨ .mjs æ‰©å±•å)
import esbuild from 'esbuild';  // âœ… å¯ä»¥ç”¨ import
console.log('Hello ESM');
```

**æ•ˆæœ**:
- âœ… `.mjs` æ–‡ä»¶æ˜ç¡®è¡¨ç¤ºè¿™æ˜¯ ES Module
- âœ… ä¸éœ€è¦ä¿®æ”¹ package.json
- âš ï¸  ä½†æ–‡ä»¶æ‰©å±•åæ¯”è¾ƒé•¿ï¼Œä¸å¤Ÿç®€æ´

---

## ğŸ“Š è¯¦ç»†å¯¹æ¯”

| æ–¹é¢ | `"type": "module"` + `.js` | `.mjs` |
|------|---------------------------|--------|
| **é…ç½®** | éœ€è¦åœ¨ package.json æ·»åŠ ä¸€è¡Œ | ä¸éœ€è¦é…ç½® |
| **æ–‡ä»¶æ‰©å±•å** | `.js` (ç®€æ´) | `.mjs` (æ˜ç¡®ä½†å†—é•¿) |
| **é¡¹ç›®ä¸€è‡´æ€§** | æ‰€æœ‰æ–‡ä»¶ç»Ÿä¸€ `.js` | æ··åˆ `.js` å’Œ `.mjs` |
| **IDE æ”¯æŒ** | å®Œç¾ | å®Œç¾ |
| **Gemini-CLI** | âœ… ä½¿ç”¨è¿™ä¸ª | âŒ |
| **æˆ‘ä»¬ä¹‹å‰** | âŒ | âœ… ä½¿ç”¨äº†è¿™ä¸ª |
| **ç°åœ¨** | âœ… æ”¹æˆè¿™ä¸ªäº† | âŒ |

---

## ğŸ¯ æœ€ä½³å®è·µï¼ˆå­¦ä¹  Gemini-CLIï¼‰

### âœ… æ¨èåšæ³•

```json
// package.json
{
  "type": "module"  // æ·»åŠ è¿™ä¸€è¡Œ
}
```

ç„¶åæ‰€æœ‰æ–‡ä»¶éƒ½ç”¨ `.js`:
- `esbuild.config.js` âœ…
- `scripts/build.js` âœ…  
- `bundle/my-cli.js` âœ…

**ä¼˜åŠ¿**:
1. **ç®€æ´**: ç»Ÿä¸€ä½¿ç”¨ `.js`
2. **æ¸…æ™°**: package.json æ˜ç¡®å£°æ˜æ¨¡å—ç±»å‹
3. **ä¸“ä¸š**: å’Œ Gemini-CLI ç­‰ä¸“ä¸šé¡¹ç›®ä¿æŒä¸€è‡´

---

## ğŸ”„ æˆ‘ä»¬åšçš„è°ƒæ•´

### ä¹‹å‰ï¼ˆä½¿ç”¨ .mjsï¼‰

```
ai-cli-project/
  â”œâ”€ esbuild.config.mjs  â† ä½¿ç”¨ .mjs
  â”œâ”€ scripts/build.mjs   â†ä½¿ç”¨ .mjs
  â””â”€ package.json        â† æ²¡æœ‰ "type": "module"
```

### ç°åœ¨ï¼ˆå­¦ä¹  Gemini-CLIï¼‰

```
ai-cli-project/
  â”œâ”€ esbuild.config.js   â† æ”¹æˆ .js âœ¨
  â”œâ”€ scripts/build.js    â† æ”¹æˆ .js âœ¨
  â””â”€ package.json
       â””â”€ "type": "module"  â† æ·»åŠ äº†è¿™ä¸ª âœ¨
```

---

## ğŸ’¡ å…³é”®ç†è§£

### é—®é¢˜ï¼šä¸ºä»€ä¹ˆ Gemini-CLI çš„ .js æ–‡ä»¶èƒ½ä½¿ç”¨ importï¼Ÿ

**ç­”æ¡ˆ**: å› ä¸º package.json æœ‰ `"type": "module"`ï¼

```json
// gemini-cli/package.json
{
  "type": "module"  // â† è¿™ä¸€è¡Œå‘Šè¯‰ Node.js: æ‰€æœ‰ .js éƒ½æ˜¯ ESM
}
```

### é—®é¢˜ï¼šæˆ‘ä»¬ä¹‹å‰ä¸ºä»€ä¹ˆç”¨ .mjsï¼Ÿ

**ç­”æ¡ˆ**: å› ä¸ºæ²¡æœ‰åœ¨ package.json æ·»åŠ  `"type": "module"`ï¼Œæ‰€ä»¥åªèƒ½ç”¨ `.mjs` æ¥æ ‡è¯† ES Moduleã€‚

### é—®é¢˜ï¼šç°åœ¨ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ç”¨å—ï¼Ÿ

**ç­”æ¡ˆ**: å¯ä»¥ï¼ä½†æ¨èç»Ÿä¸€ä½¿ç”¨ä¸€ç§ï¼š

| æ–¹å¼ | é€‚ç”¨åœºæ™¯ |
|------|---------|
| `"type": "module"` + `.js` | âœ… å¤§å‹é¡¹ç›®ã€ä¸“ä¸šé¡¹ç›® |
| `.mjs` | ç®€å•è„šæœ¬ã€æ··åˆé¡¹ç›® |

---

## ğŸ“ åç«¯ç±»æ¯”

### Java çš„ç±»æ¯”

```java
// ç±»ä¼¼äºåœ¨ Java ä¸­æŒ‡å®šæ¨¡å—ç±»å‹

// æ–¹å¼1: åœ¨ module-info.java å£°æ˜æ¨¡å—
module com.example.app {
    exports com.example;
}

// æ–¹å¼2: ç›´æ¥åœ¨æ–‡ä»¶åä¸­æ ‡è¯†
MyClass.ejb.java  // ç±»ä¼¼ .mjsï¼Œç”¨æ–‡ä»¶åæ ‡è¯†ç±»å‹
```

### Maven/Gradle çš„ç±»æ¯”

```xml
<!-- åœ¨ pom.xml å…¨å±€é…ç½® -->
<properties>
    <java.version>17</java.version>  <!-- ç±»ä¼¼ "type": "module" -->
</properties>
```

vs

```java
// åœ¨æ¯ä¸ªæ–‡ä»¶å¤´éƒ¨å£°æ˜
@UseJava17  // ç±»ä¼¼ä½¿ç”¨ .mjs åœ¨æ–‡ä»¶çº§åˆ«æ ‡è¯†
```

---

## ğŸ“ æ€»ç»“

### 1. `.js` vs `.mjs` 

- **`.js` with `"type": "module"`** âœ… (Gemini-CLI çš„é€‰æ‹©)
  - éœ€è¦é…ç½®ä½†æ›´ç»Ÿä¸€
  - ä¸“ä¸šé¡¹ç›®çš„æ ‡å‡†åšæ³•
  
- **`.mjs`** 
  - æ— éœ€é…ç½®ä½†æ–‡ä»¶åå†—é•¿
  - é€‚åˆä¸´æ—¶è„šæœ¬æˆ–æ··åˆé¡¹ç›®

### 2. æˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆ

- âœ… ç†è§£äº† Node.js çš„ä¸¤ç§æ¨¡å—ç³»ç»Ÿ
- âœ… çŸ¥é“äº†å¦‚ä½•å‘Šè¯‰ Node.js ä½¿ç”¨ ES Module
- âœ… å­¦ä¼šäº† Gemini-CLI çš„æœ€ä½³å®è·µ
- âœ… æŒæ¡äº† `"type": "module"` çš„ä½œç”¨

### 3. å»ºè®®

å¯¹äºå­¦ä¹ é¡¹ç›®ï¼Œ**æ¨èä½¿ç”¨ `"type": "module"` + `.js`**ï¼š
1. å’Œä¸“ä¸šé¡¹ç›®ä¿æŒä¸€è‡´
2. æ›´ç®€æ´ç»Ÿä¸€
3. ä¾¿äºç†è§£å’Œç»´æŠ¤

---

## ğŸ”— å‚è€ƒ

- [Node.js ES Modules æ–‡æ¡£](https://nodejs.org/api/esm.html)
- [Gemini-CLI package.json](https://github.com/google-gemini/gemini-cli/blob/main/package.json)
